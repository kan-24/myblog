import{r as f,c as k,a as r,o as n,d as e,b as V,q as A,v as N,F as S,f as $,l as L,z as D,t as v,K,L as M,M as P,N as z,u as I,m as j,j as g,k as B,A as h}from"./index-pPjq6uOp.js";import{u as F}from"./posts-C-_0jTyP.js";import{u as T}from"./comments-BRPoRqEe.js";const q={class:"mb-3 flex flex-wrap items-center gap-3"},E={class:"overflow-x-auto rounded-lg border border-slate-200 dark:border-slate-700"},O={class:"min-w-full divide-y divide-slate-200 text-sm dark:divide-slate-700"},U={class:"bg-slate-100 dark:bg-slate-900"},G=["onClick"],H={key:0},J={class:"divide-y divide-slate-200 dark:divide-slate-800"},Q={class:"mt-4 flex items-center justify-between text-xs text-slate-500"},R={class:"flex items-center gap-2"},W=["disabled"],X=["disabled"],w={__name:"AdminTable",props:{rows:{type:Array,default:()=>[]},columns:{type:Array,default:()=>[]},pageSize:{type:Number,default:10},rowKey:{type:Function,required:!0}},setup(b){const d=b,u=f(""),o=f(""),i=f("asc"),a=f(1),m=k(()=>d.pageSize??10),y=k(()=>u.value?d.rows.filter(t=>Object.values(t).some(s=>String(s).toLowerCase().includes(u.value.toLowerCase()))):d.rows),p=k(()=>o.value?[...y.value].sort((t,s)=>{const l=i.value==="asc"?1:-1;return t[o.value]>s[o.value]?l:t[o.value]<s[o.value]?-l:0}):y.value),x=k(()=>Math.max(1,Math.ceil(p.value.length/m.value))),_=k(()=>{const t=(a.value-1)*m.value;return p.value.slice(t,t+m.value)}),C=t=>{o.value===t?i.value=i.value==="asc"?"desc":"asc":(o.value=t,i.value="asc")};return(t,s)=>(n(),r("div",null,[e("div",q,[V(e("input",{"onUpdate:modelValue":s[0]||(s[0]=l=>u.value=l),type:"search",placeholder:"搜索...",class:"rounded border border-slate-200 px-3 py-2 text-sm dark:border-slate-700 dark:bg-slate-800"},null,512),[[N,u.value]]),A(t.$slots,"controls")]),e("div",E,[e("table",O,[e("thead",U,[e("tr",null,[(n(!0),r(S,null,$(b.columns,l=>(n(),r("th",{key:l.key,class:"px-4 py-2 text-left font-medium text-slate-600 dark:text-slate-300"},[e("button",{class:"flex items-center gap-1",onClick:c=>C(l.key)},[L(v(l.label)+" ",1),o.value===l.key?(n(),r("span",H,v(i.value==="asc"?"▲":"▼"),1)):D("",!0)],8,G)]))),128))])]),e("tbody",J,[(n(!0),r(S,null,$(_.value,l=>(n(),r("tr",{key:b.rowKey(l),class:"bg-white hover:bg-slate-50 dark:bg-slate-900 dark:hover:bg-slate-950"},[(n(!0),r(S,null,$(b.columns,c=>(n(),r("td",{key:c.key,class:"px-4 py-2"},[A(t.$slots,c.key,{row:l},()=>[L(v(l[c.key]),1)])]))),128))]))),128))])])]),e("div",Q,[e("span",null,"共 "+v(y.value.length)+" 条",1),e("div",R,[e("button",{class:"rounded px-2 py-1 hover:bg-slate-100 dark:hover:bg-slate-800",disabled:a.value===1,onClick:s[1]||(s[1]=l=>a.value--)}," 上一页 ",8,W),e("span",null,"第 "+v(a.value)+" / "+v(x.value)+" 页",1),e("button",{class:"rounded px-2 py-1 hover:bg-slate-100 dark:hover:bg-slate-800",disabled:a.value===x.value,onClick:s[2]||(s[2]=l=>a.value++)}," 下一页 ",8,X)])])]))}},Y=K("visitors",{state:()=>({visitors:M("visitors",[]),loaded:!1}),actions:{async ensureLoaded(){this.loaded||(this.visitors.length||(this.visitors=await P(),z("visitors",this.visitors)),this.loaded=!0)}}}),Z={class:"mx-auto max-w-6xl space-y-10"},ee={class:"space-y-6"},te={class:"flex gap-2"},se=["onClick"],le=["onClick"],ne={__name:"AdminDashboardView",setup(b){const d=F(),u=T(),o=I(),i=Y(),a=t=>t.id,m=[{key:"title",label:"标题"},{key:"category",label:"分类"},{key:"publishedAt",label:"发布时间"},{key:"views",label:"浏览"},{key:"likes",label:"点赞"},{key:"actions",label:"操作"}],y=[{key:"postId",label:"文章 ID"},{key:"content",label:"内容"},{key:"authorId",label:"作者"},{key:"createdAt",label:"时间"}],p=[{key:"name",label:"姓名"},{key:"email",label:"邮箱"},{key:"role",label:"角色"},{key:"language",label:"语言"}],x=[{key:"location",label:"来源"},{key:"userAgent",label:"设备"},{key:"referrer",label:"入口"},{key:"enteredAt",label:"时间"}],_=t=>{window.alert(`编辑文章 ${t}（演示）`)},C=t=>{d.remove(t)};return j(async()=>{var t;await Promise.all([d.ensureLoaded(),u.ensureLoaded(),(t=o.ensureLoaded)==null?void 0:t.call(o),i.ensureLoaded()])}),(t,s)=>(n(),r("section",Z,[s[4]||(s[4]=e("header",null,[e("h1",{class:"text-2xl font-bold"},"管理后台"),e("p",{class:"text-sm text-slate-500"},"文章、评论、用户与访客管理（演示数据）。")],-1)),e("div",ee,[e("div",null,[s[0]||(s[0]=e("h2",{class:"mb-3 text-lg font-semibold"},"文章管理",-1)),g(w,{rows:h(d).posts,columns:m,"row-key":a},{actions:B(({row:l})=>[e("div",te,[e("button",{class:"text-xs text-brand",onClick:c=>_(l.id)},"编辑",8,se),e("button",{class:"text-xs text-red-500",onClick:c=>C(l.id)},"删除",8,le)])]),_:1},8,["rows"])]),e("div",null,[s[1]||(s[1]=e("h2",{class:"mb-3 text-lg font-semibold"},"评论管理",-1)),g(w,{rows:h(u).comments,columns:y,"row-key":a},null,8,["rows"])]),e("div",null,[s[2]||(s[2]=e("h2",{class:"mb-3 text-lg font-semibold"},"用户管理",-1)),g(w,{rows:h(o).users,columns:p,"row-key":a},null,8,["rows"])]),e("div",null,[s[3]||(s[3]=e("h2",{class:"mb-3 text-lg font-semibold"},"访客记录",-1)),g(w,{rows:h(i).visitors,columns:x,"row-key":a},null,8,["rows"])])])]))}};export{ne as default};
