import{u as B}from"./posts-Ya1uPzsY.js";import{u as F}from"./comments-BALQWqPH.js";import{u as V,r as b,w as I,c as f,a as d,o as a,b as y,d as e,v as N,e as g,t as r,f as S,F as w,g as k,h as A,i as U,j as D,k as L,l as P,m as T,n as Y,p as O,q,s as z,x as $,y as M}from"./index-D9tgDiJn.js";import{d as H}from"./dayjs.min-D8ihKSvH.js";const E={class:"grid gap-3 md:grid-cols-[1fr_auto_auto_auto]"},G=["placeholder"],J={value:""},K=["value"],Q={value:""},R=["value"],W={__name:"ArticleFilters",props:{categories:{type:Array,default:()=>[]},tags:{type:Array,default:()=>[]}},emits:["change"],setup(l,{emit:n}){const h=l,m=n,{t:c}=V(),o=b(""),t=b(""),p=b(""),x=()=>{m("change",{search:o.value,category:t.value,tag:p.value})};I([o,t,p],x);const C=f(()=>h.categories),v=f(()=>h.tags);return(u,i)=>(a(),d("div",E,[y(e("input",{"onUpdate:modelValue":i[0]||(i[0]=s=>o.value=s),type:"search",placeholder:g(c)("filters.searchPlaceholder"),class:"w-full rounded border border-slate-200 px-3 py-2 text-sm focus:border-brand focus:outline-none dark:border-slate-700 dark:bg-slate-800"},null,8,G),[[N,o.value]]),e("button",{type:"button",class:"rounded border border-brand bg-brand px-3 py-2 text-sm font-medium text-white transition-colors hover:bg-brand-dark",onClick:x},r(g(c)("filters.searchButton")),1),y(e("select",{"onUpdate:modelValue":i[1]||(i[1]=s=>t.value=s),class:"rounded border border-slate-200 px-3 py-2 text-sm dark:border-slate-700 dark:bg-slate-800"},[e("option",J,r(g(c)("filters.allCategories")),1),(a(!0),d(w,null,k(C.value,s=>(a(),d("option",{key:s,value:s},r(s),9,K))),128))],512),[[S,t.value]]),y(e("select",{"onUpdate:modelValue":i[2]||(i[2]=s=>p.value=s),class:"rounded border border-slate-200 px-3 py-2 text-sm dark:border-slate-700 dark:bg-slate-800"},[e("option",Q,r(g(c)("filters.allTags")),1),(a(!0),d(w,null,k(v.value,s=>(a(),d("option",{key:s,value:s},"#"+r(s),9,R))),128))],512),[[S,p.value]])]))}},X={class:"group flex flex-col gap-4 overflow-hidden rounded-2xl border border-slate-200 bg-white/65 shadow transition hover:shadow-lg dark:border-slate-800 dark:bg-slate-900/65 md:flex-row md:items-stretch"},Z={class:"relative overflow-hidden md:max-w-[220px] lg:max-w-[260px]"},ee={class:"aspect-[4/3] md:aspect-[3/2]"},te={alt:"",class:"h-full w-full object-cover transition group-hover:scale-105"},se={class:"flex flex-1 flex-col space-y-2 px-4 pb-4 md:py-4"},oe={class:"flex flex-wrap items-center gap-2 text-xs uppercase tracking-wide text-brand"},ae={class:"line-clamp-2 text-sm text-slate-600 dark:text-slate-300 md:line-clamp-3"},re={class:"mt-auto flex flex-wrap items-center justify-between gap-2 text-xs text-slate-500"},le={class:"flex items-center gap-3"},ne={class:"flex flex-wrap gap-1"},ce={__name:"ArticleCard",props:{post:{type:Object,required:!0}},setup(l){const n=l,h=f(()=>H(n.post.publishedAt).format("YYYY-MM-DD"));return(m,c)=>{const o=A("router-link"),t=U("lazy");return a(),d("article",X,[e("div",Z,[e("div",ee,[y(e("img",te,null,512),[[t,l.post.cover]])])]),e("div",se,[e("div",oe,[e("span",null,r(l.post.category),1),c[0]||(c[0]=e("span",null,"â€¢",-1)),e("time",null,r(h.value),1)]),D(o,{to:`/posts/${l.post.id}`,class:"text-base font-semibold leading-snug md:text-lg"},{default:L(()=>[P(r(l.post.title),1)]),_:1},8,["to"]),e("p",ae,r(l.post.summary),1),e("div",re,[e("div",le,[e("span",null,"ðŸ‘ï¸ "+r(l.post.views),1),e("span",null,"â¤ï¸ "+r(l.post.likes),1),e("span",null,"â­ "+r(l.post.favorites),1)]),e("div",ne,[(a(!0),d(w,null,k(l.post.tags,p=>(a(),d("span",{key:p,class:"rounded-full bg-slate-100 px-2 py-1 dark:bg-slate-800"}," #"+r(p),1))),128))])])])])}}},ie={__name:"IntersectionObserver",emits:["intersect"],setup(l,{emit:n}){const h=n,m=b(null);let c=null;return T(()=>{m.value&&(c=new IntersectionObserver(([o])=>{o.isIntersecting&&h("intersect")}),c.observe(m.value))}),Y(()=>{c&&m.value&&c.unobserve(m.value)}),(o,t)=>(a(),d("div",{ref_key:"target",ref:m,class:"h-1 w-full"},null,512))}},de={class:"mx-auto flex max-w-6xl flex-col gap-6"},ue={class:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between"},me={key:0,class:"space-y-4"},pe={key:1,class:"py-16 text-center text-slate-500"},ve={__name:"HomeView",setup(l){const n=B(),h=F(),m=O(),c=f(()=>{var u;return((u=m.user)==null?void 0:u.role)==="admin"}),{t:o}=V(),t=q({search:"",category:"",tag:""}),p=async()=>{n.loading||!n.hasMore||await n.fetchNextPage()},x=u=>{t.search=u.search,t.category=u.category,t.tag=u.tag},C=f(()=>{const u=t.search.toLowerCase();return n.posts.filter(i=>{const s=!t.search||i.title.toLowerCase().includes(u)||i.summary.toLowerCase().includes(u),_=!t.category||i.category===t.category,j=!t.tag||i.tags.includes(t.tag);return s&&_&&j})}),v=f(()=>C.value);return T(async()=>{await Promise.all([n.ensureLoaded(),h.ensureLoaded()])}),z(()=>({title:o("home.title"),meta:[{name:"description",content:o("home.description")},{property:"og:title",content:o("home.ogTitle")},{property:"og:description",content:o("home.ogDescription")},{property:"og:type",content:"website"}],link:[{rel:"canonical",href:"https://example.com/"}]})),(u,i)=>{const s=A("router-link");return a(),d("section",de,[e("div",ue,[i[0]||(i[0]=e("div",null,null,-1)),c.value?(a(),$(s,{key:0,to:"/editor",class:"inline-flex items-center gap-2 rounded-full bg-brand px-4 py-2 text-sm font-medium text-white hover:bg-brand-dark"},{default:L(()=>[P(r(g(o)("home.newPost")),1)]),_:1})):M("",!0)]),D(W,{categories:g(n).categories,tags:g(n).tags,onChange:x},null,8,["categories","tags"]),v.value.length?(a(),d("div",me,[(a(!0),d(w,null,k(v.value,_=>(a(),$(ce,{key:_.id,post:_},null,8,["post"]))),128))])):(a(),d("p",pe,r(g(o)("home.empty")),1)),g(n).hasMore?(a(),$(ie,{key:2,onIntersect:p})):M("",!0)])}}};export{ve as default};
