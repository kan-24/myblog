import{d as V,r as g,c as k,a as r,o as n,e,b as D,s as L,v as M,F as C,g as S,t as v,m as A,A as N,L as P,M as B,N as I,O as K,u as z,n as F,k as x,l as T,B as f}from"./index-CuV8GAmF.js";import{u as j}from"./posts-Df1r2n3E.js";import{u as O}from"./comments-BqzYk5VS.js";const E={class:"mb-3 flex flex-wrap items-center gap-3"},U={class:"overflow-x-auto rounded-lg border border-slate-200 dark:border-slate-700"},q={class:"min-w-full divide-y divide-slate-200 text-sm dark:divide-slate-700"},G={class:"bg-slate-100 dark:bg-slate-900"},H=["onClick"],J={key:0},Q={class:"divide-y divide-slate-200 dark:divide-slate-800"},R={class:"mt-4 flex items-center justify-between text-xs text-slate-500"},W={class:"flex items-center gap-2"},X=["disabled"],Y=["disabled"],h=V({__name:"AdminTable",props:{rows:{},columns:{},pageSize:{},rowKey:{type:Function}},setup($){const d=$,u=g(""),o=g(""),i=g("asc"),a=g(1),b=k(()=>d.pageSize??10),m=k(()=>u.value?d.rows.filter(s=>Object.values(s).some(t=>String(t).toLowerCase().includes(u.value.toLowerCase()))):d.rows),p=k(()=>o.value?[...m.value].sort((s,t)=>{const l=i.value==="asc"?1:-1;return s[o.value]>t[o.value]?l:s[o.value]<t[o.value]?-l:0}):m.value),y=k(()=>Math.max(1,Math.ceil(p.value.length/b.value))),w=k(()=>{const s=(a.value-1)*b.value;return p.value.slice(s,s+b.value)}),_=s=>{o.value===s?i.value=i.value==="asc"?"desc":"asc":(o.value=s,i.value="asc")};return(s,t)=>(n(),r("div",null,[e("div",E,[D(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>u.value=l),type:"search",placeholder:"搜索...",class:"rounded border border-slate-200 px-3 py-2 text-sm dark:border-slate-700 dark:bg-slate-800"},null,512),[[M,u.value]]),L(s.$slots,"controls")]),e("div",U,[e("table",q,[e("thead",G,[e("tr",null,[(n(!0),r(C,null,S(s.columns,l=>(n(),r("th",{key:l.key,class:"px-4 py-2 text-left font-medium text-slate-600 dark:text-slate-300"},[e("button",{class:"flex items-center gap-1",onClick:c=>_(l.key)},[A(v(l.label)+" ",1),o.value===l.key?(n(),r("span",J,v(i.value==="asc"?"▲":"▼"),1)):N("",!0)],8,H)]))),128))])]),e("tbody",Q,[(n(!0),r(C,null,S(w.value,l=>(n(),r("tr",{key:s.rowKey(l),class:"bg-white hover:bg-slate-50 dark:bg-slate-900 dark:hover:bg-slate-950"},[(n(!0),r(C,null,S(s.columns,c=>(n(),r("td",{key:c.key,class:"px-4 py-2"},[L(s.$slots,c.key,{row:l},()=>[A(v(l[c.key]),1)])]))),128))]))),128))])])]),e("div",R,[e("span",null,"共 "+v(m.value.length)+" 条",1),e("div",W,[e("button",{class:"rounded px-2 py-1 hover:bg-slate-100 dark:hover:bg-slate-800",disabled:a.value===1,onClick:t[1]||(t[1]=l=>a.value--)}," 上一页 ",8,X),e("span",null,"第 "+v(a.value)+" / "+v(y.value)+" 页",1),e("button",{class:"rounded px-2 py-1 hover:bg-slate-100 dark:hover:bg-slate-800",disabled:a.value===y.value,onClick:t[2]||(t[2]=l=>a.value++)}," 下一页 ",8,Y)])])]))}}),Z=P("visitors",{state:()=>({visitors:B("visitors",[]),loaded:!1}),actions:{async ensureLoaded(){this.loaded||(this.visitors.length||(this.visitors=await I(),K("visitors",this.visitors)),this.loaded=!0)}}}),ee={class:"mx-auto max-w-6xl space-y-10"},se={class:"space-y-6"},te={class:"flex gap-2"},le=["onClick"],oe=["onClick"],ie=V({__name:"AdminDashboardView",setup($){const d=j(),u=O(),o=z(),i=Z(),a=s=>s.id,b=[{key:"title",label:"标题"},{key:"category",label:"分类"},{key:"publishedAt",label:"发布时间"},{key:"views",label:"浏览"},{key:"likes",label:"点赞"},{key:"actions",label:"操作"}],m=[{key:"postId",label:"文章 ID"},{key:"content",label:"内容"},{key:"authorId",label:"作者"},{key:"createdAt",label:"时间"}],p=[{key:"name",label:"姓名"},{key:"email",label:"邮箱"},{key:"role",label:"角色"},{key:"language",label:"语言"}],y=[{key:"location",label:"来源"},{key:"userAgent",label:"设备"},{key:"referrer",label:"入口"},{key:"enteredAt",label:"时间"}],w=s=>{window.alert(`编辑文章 ${s}（演示）`)},_=s=>{d.remove(s)};return F(async()=>{var s;await Promise.all([d.ensureLoaded(),u.ensureLoaded(),(s=o.ensureLoaded)==null?void 0:s.call(o),i.ensureLoaded()])}),(s,t)=>(n(),r("section",ee,[t[4]||(t[4]=e("header",null,[e("h1",{class:"text-2xl font-bold"},"管理后台"),e("p",{class:"text-sm text-slate-500"},"文章、评论、用户与访客管理（演示数据）。")],-1)),e("div",se,[e("div",null,[t[0]||(t[0]=e("h2",{class:"mb-3 text-lg font-semibold"},"文章管理",-1)),x(h,{rows:f(d).posts,columns:b,"row-key":a},{actions:T(({row:l})=>[e("div",te,[e("button",{class:"text-xs text-brand",onClick:c=>w(l.id)},"编辑",8,le),e("button",{class:"text-xs text-red-500",onClick:c=>_(l.id)},"删除",8,oe)])]),_:1},8,["rows"])]),e("div",null,[t[1]||(t[1]=e("h2",{class:"mb-3 text-lg font-semibold"},"评论管理",-1)),x(h,{rows:f(u).comments,columns:m,"row-key":a},null,8,["rows"])]),e("div",null,[t[2]||(t[2]=e("h2",{class:"mb-3 text-lg font-semibold"},"用户管理",-1)),x(h,{rows:f(o).users,columns:p,"row-key":a},null,8,["rows"])]),e("div",null,[t[3]||(t[3]=e("h2",{class:"mb-3 text-lg font-semibold"},"访客记录",-1)),x(h,{rows:f(i).visitors,columns:y,"row-key":a},null,8,["rows"])])])]))}});export{ie as default};
