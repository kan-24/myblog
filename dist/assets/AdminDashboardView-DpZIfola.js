import{r as x,c,a as d,o as i,d as s,b as V,A,v as D,F as w,g as $,l as L,y as N,t as n,p as P,u as I,m as K,e as r,j as C,k as M,H as j}from"./index-D9tgDiJn.js";import{u as z}from"./posts-Ya1uPzsY.js";import{u as B}from"./comments-BALQWqPH.js";const F={class:"mb-3 flex flex-wrap items-center gap-3"},T={class:"overflow-x-auto rounded-lg border border-slate-200 dark:border-slate-700"},E={class:"min-w-full divide-y divide-slate-200 text-sm dark:divide-slate-700"},q={class:"bg-slate-100 dark:bg-slate-900"},H=["onClick"],O={key:0},R={class:"divide-y divide-slate-200 dark:divide-slate-800"},U={class:"mt-4 flex items-center justify-between text-xs text-slate-500"},G={class:"flex items-center gap-2"},J=["disabled"],Q=["disabled"],S={__name:"AdminTable",props:{rows:{type:Array,default:()=>[]},columns:{type:Array,default:()=>[]},pageSize:{type:Number,default:10},rowKey:{type:Function,required:!0}},setup(y){const u=y,m=x(""),o=x(""),v=x("asc"),e=x(1),p=c(()=>u.pageSize??10),k=c(()=>m.value?u.rows.filter(t=>Object.values(t).some(l=>String(l).toLowerCase().includes(m.value.toLowerCase()))):u.rows),h=c(()=>o.value?[...k.value].sort((t,l)=>{const a=v.value==="asc"?1:-1;return t[o.value]>l[o.value]?a:t[o.value]<l[o.value]?-a:0}):k.value),_=c(()=>Math.max(1,Math.ceil(h.value.length/p.value))),f=c(()=>{const t=(e.value-1)*p.value;return h.value.slice(t,t+p.value)}),g=t=>{o.value===t?v.value=v.value==="asc"?"desc":"asc":(o.value=t,v.value="asc")};return(t,l)=>(i(),d("div",null,[s("div",F,[V(s("input",{"onUpdate:modelValue":l[0]||(l[0]=a=>m.value=a),type:"search",placeholder:"搜索...",class:"rounded border border-slate-200 px-3 py-2 text-sm dark:border-slate-700 dark:bg-slate-800"},null,512),[[D,m.value]]),A(t.$slots,"controls")]),s("div",T,[s("table",E,[s("thead",q,[s("tr",null,[(i(!0),d(w,null,$(y.columns,a=>(i(),d("th",{key:a.key,class:"px-4 py-2 text-left font-medium text-slate-600 dark:text-slate-300"},[s("button",{class:"flex items-center gap-1",onClick:b=>g(a.key)},[L(n(a.label)+" ",1),o.value===a.key?(i(),d("span",O,n(v.value==="asc"?"▲":"▼"),1)):N("",!0)],8,H)]))),128))])]),s("tbody",R,[(i(!0),d(w,null,$(f.value,a=>(i(),d("tr",{key:y.rowKey(a),class:"bg-white hover:bg-slate-50 dark:bg-slate-900 dark:hover:bg-slate-950"},[(i(!0),d(w,null,$(y.columns,b=>(i(),d("td",{key:b.key,class:"px-4 py-2"},[A(t.$slots,b.key,{row:a},()=>[L(n(a[b.key]),1)])]))),128))]))),128))])])]),s("div",U,[s("span",null,"共 "+n(k.value.length)+" 条",1),s("div",G,[s("button",{class:"rounded px-2 py-1 hover:bg-slate-100 dark:hover:bg-slate-800",disabled:e.value===1,onClick:l[1]||(l[1]=a=>e.value--)}," 上一页 ",8,J),s("span",null,"第 "+n(e.value)+" / "+n(_.value)+" 页",1),s("button",{class:"rounded px-2 py-1 hover:bg-slate-100 dark:hover:bg-slate-800",disabled:e.value===_.value,onClick:l[2]||(l[2]=a=>e.value++)}," 下一页 ",8,Q)])])]))}},W={class:"mx-auto max-w-6xl space-y-10"},X={class:"text-2xl font-bold"},Y={class:"text-sm text-slate-500"},Z={class:"space-y-6"},ee={class:"mb-3 text-lg font-semibold"},se={class:"flex gap-2"},te=["onClick"],ae=["onClick"],oe={class:"mb-3 text-lg font-semibold"},le={class:"mb-3 text-lg font-semibold"},ie={__name:"AdminDashboardView",setup(y){const u=z(),m=B(),o=P(),v=j(),{t:e}=I(),p=t=>t.id,k=c(()=>[{key:"title",label:e("admin.posts.columns.title")},{key:"category",label:e("admin.posts.columns.category")},{key:"publishedAt",label:e("admin.posts.columns.publishedAt")},{key:"views",label:e("admin.posts.columns.views")},{key:"likes",label:e("admin.posts.columns.likes")},{key:"actions",label:e("admin.posts.columns.actions")}]),h=c(()=>[{key:"postId",label:e("admin.comments.columns.postId")},{key:"content",label:e("admin.comments.columns.content")},{key:"authorId",label:e("admin.comments.columns.author")},{key:"createdAt",label:e("admin.comments.columns.createdAt")}]),_=c(()=>[{key:"name",label:e("admin.users.columns.name")},{key:"email",label:e("admin.users.columns.email")},{key:"role",label:e("admin.users.columns.role")},{key:"language",label:e("admin.users.columns.language")}]),f=t=>{v.push({name:"editor",params:{id:t}})},g=async t=>{if(window.confirm(e("admin.alerts.confirmDelete")))try{await u.remove(t),window.alert(e("admin.alerts.deleteSuccess"))}catch(a){console.error(a),window.alert((a==null?void 0:a.message)??e("admin.alerts.deleteError"))}};return K(async()=>{var t;await Promise.all([u.ensureLoaded(),m.ensureLoaded(),(t=o.ensureLoaded)==null?void 0:t.call(o)])}),(t,l)=>(i(),d("section",W,[s("header",null,[s("h1",X,n(r(e)("admin.title")),1),s("p",Y,n(r(e)("admin.description")),1)]),s("div",Z,[s("div",null,[s("h2",ee,n(r(e)("admin.sections.posts")),1),C(S,{rows:r(u).posts,columns:k.value,"row-key":p},{actions:M(({row:a})=>[s("div",se,[s("button",{class:"text-xs text-brand",onClick:b=>f(a.id)},n(r(e)("admin.posts.actions.edit")),9,te),s("button",{class:"text-xs text-red-500",onClick:b=>g(a.id)},n(r(e)("admin.posts.actions.delete")),9,ae)])]),_:1},8,["rows","columns"])]),s("div",null,[s("h2",oe,n(r(e)("admin.sections.comments")),1),C(S,{rows:r(m).comments,columns:h.value,"row-key":p},null,8,["rows","columns"])]),s("div",null,[s("h2",le,n(r(e)("admin.sections.users")),1),C(S,{rows:r(o).users,columns:_.value,"row-key":p},null,8,["rows","columns"])])])]))}};export{ie as default};
