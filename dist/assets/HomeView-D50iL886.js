import{u as N}from"./posts-C-_0jTyP.js";import{u as j}from"./comments-BRPoRqEe.js";import{r as h,w as V,c as f,a as d,o as i,b as y,v as D,d as t,e as L,F as _,f as k,t as p,g as H,h as B,i as Y,j as b,k as C,l as T,m as z,n as F,p as $,q,u as P,s as U,x as X,y as A,z as E,A as M}from"./index-pPjq6uOp.js";const O={class:"grid gap-3 md:grid-cols-[1fr_auto_auto]"},R=["value"],G=["value"],J={__name:"ArticleFilters",props:{categories:{type:Array,default:()=>[]},tags:{type:Array,default:()=>[]}},emits:["change"],setup(r,{emit:s}){const c=r,u=s,n=h(""),a=h(""),m=h("");V([n,a,m],()=>{u("change",{search:n.value,category:a.value,tag:m.value})});const g=f(()=>c.categories),l=f(()=>c.tags);return(x,o)=>(i(),d("div",O,[y(t("input",{"onUpdate:modelValue":o[0]||(o[0]=e=>n.value=e),type:"search",placeholder:"æœç´¢æ–‡ç« ...",class:"w-full rounded border border-slate-200 px-3 py-2 text-sm focus:border-brand focus:outline-none dark:border-slate-700 dark:bg-slate-800"},null,512),[[D,n.value]]),y(t("select",{"onUpdate:modelValue":o[1]||(o[1]=e=>a.value=e),class:"rounded border border-slate-200 px-3 py-2 text-sm dark:border-slate-700 dark:bg-slate-800"},[o[3]||(o[3]=t("option",{value:""},"å…¨éƒ¨åˆ†ç±»",-1)),(i(!0),d(_,null,k(g.value,e=>(i(),d("option",{key:e,value:e},p(e),9,R))),128))],512),[[L,a.value]]),y(t("select",{"onUpdate:modelValue":o[2]||(o[2]=e=>m.value=e),class:"rounded border border-slate-200 px-3 py-2 text-sm dark:border-slate-700 dark:bg-slate-800"},[o[4]||(o[4]=t("option",{value:""},"å…¨éƒ¨æ ‡ç­¾",-1)),(i(!0),d(_,null,k(l.value,e=>(i(),d("option",{key:e,value:e},"#"+p(e),9,G))),128))],512),[[L,m.value]])]))}},K={class:"group flex flex-col overflow-hidden rounded-2xl border border-slate-200 bg-white/65 shadow transition hover:shadow-lg dark:border-slate-800 dark:bg-slate-900/65"},Q={class:"relative aspect-[16/9] overflow-hidden"},W={alt:"",class:"h-full w-full object-cover transition group-hover:scale-105"},Z={class:"flex flex-1 flex-col space-y-3 p-4"},ee={class:"flex items-center gap-2 text-xs uppercase tracking-wide text-brand"},te={class:"line-clamp-3 text-sm text-slate-600 dark:text-slate-300"},se={class:"mt-auto flex flex-wrap items-center justify-between text-xs text-slate-500"},ae={class:"flex items-center gap-2"},oe={class:"flex flex-wrap gap-1"},le={__name:"ArticleCard",props:{post:{type:Object,required:!0}},setup(r){const s=r,c=f(()=>H(s.post.publishedAt).format("YYYY-MM-DD"));return(u,n)=>{const a=B("router-link"),m=Y("lazy");return i(),d("article",K,[t("div",Q,[y(t("img",W,null,512),[[m,r.post.cover]])]),t("div",Z,[t("div",ee,[t("span",null,p(r.post.category),1),n[0]||(n[0]=t("span",null,"â€¢",-1)),t("time",null,p(c.value),1)]),b(a,{to:`/posts/${r.post.id}`,class:"text-lg font-semibold leading-snug"},{default:C(()=>[T(p(r.post.title),1)]),_:1},8,["to"]),t("p",te,p(r.post.summary),1),t("div",se,[t("div",ae,[t("span",null,"ğŸ‘ï¸ "+p(r.post.views),1),t("span",null,"â¤ï¸ "+p(r.post.likes),1),t("span",null,"â­ "+p(r.post.favorites),1)]),t("div",oe,[(i(!0),d(_,null,k(r.post.tags,g=>(i(),d("span",{key:g,class:"rounded-full bg-slate-100 px-2 py-1 dark:bg-slate-800"}," #"+p(g),1))),128))])])])])}}},re={__name:"VirtualList",props:{items:{type:Array,default:()=>[]},itemSize:{type:Number,required:!0},height:{type:Number,required:!0},keyField:{type:[String,Number],default:null}},setup(r){const s=r,c=h(null),u=h(0),n=f(()=>Math.ceil(s.height/s.itemSize)+1),a=f(()=>s.items.length*s.itemSize),m=f(()=>{const l=Math.floor(u.value/s.itemSize),x=Math.min(l+n.value,s.items.length);return s.items.slice(l,x).map((o,e)=>({key:s.keyField?o[s.keyField]:l+e,offset:(l+e)*s.itemSize,data:o}))}),g=()=>{var l;u.value=((l=c.value)==null?void 0:l.scrollTop)??0};return V(()=>s.items.length,()=>{c.value&&(c.value.scrollTop=0,u.value=0)}),z(()=>{var l;(l=c.value)==null||l.addEventListener("scroll",g,{passive:!0})}),F(()=>{var l;(l=c.value)==null||l.removeEventListener("scroll",g)}),(l,x)=>(i(),d("div",{ref_key:"containerRef",ref:c,class:"relative w-full overflow-y-auto",style:$({height:`${r.height}px`})},[t("div",{class:"relative w-full",style:$({height:`${a.value}px`})},[(i(!0),d(_,null,k(m.value,o=>(i(),d("div",{key:o.key,class:"absolute left-0 right-0",style:$({transform:`translateY(${o.offset}px)`})},[q(l.$slots,"default",{item:o.data})],4))),128))],4)],4))}},ne={__name:"IntersectionObserver",emits:["intersect"],setup(r,{emit:s}){const c=s,u=h(null);let n=null;return z(()=>{u.value&&(n=new IntersectionObserver(([a])=>{a.isIntersecting&&c("intersect")}),n.observe(u.value))}),F(()=>{n&&u.value&&n.unobserve(u.value)}),(a,m)=>(i(),d("div",{ref_key:"target",ref:u,class:"h-1 w-full"},null,512))}},ie={class:"mx-auto flex max-w-6xl flex-col gap-6"},ce={class:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between"},ue={key:1,class:"py-16 text-center text-slate-500"},de=10,me=320,pe=900,he={__name:"HomeView",setup(r){const s=N(),c=j(),u=P(),n=f(()=>{var e;return((e=u.user)==null?void 0:e.role)==="admin"}),a=U({search:"",category:"",tag:""}),m=h(1),g=()=>{m.value+=1},l=e=>{a.search=e.search,a.category=e.category,a.tag=e.tag,m.value=1},x=f(()=>{const e=a.search.toLowerCase();return s.posts.filter(v=>{const w=!a.search||v.title.toLowerCase().includes(e)||v.summary.toLowerCase().includes(e),S=!a.category||v.category===a.category,I=!a.tag||v.tags.includes(a.tag);return w&&S&&I})}),o=f(()=>x.value.slice(0,m.value*de));return z(async()=>{await Promise.all([s.ensureLoaded(),c.ensureLoaded()])}),X({title:"BlogX | ç°ä»£èŒä¸šåšå®¢",meta:[{name:"description",content:"BlogX â€”â€” å±•ç¤ºä½œå“ã€åˆ†äº«æ´å¯Ÿã€è¿æ¥æœºä¼šçš„ç°ä»£ä¸ªäººåšå®¢ã€‚"},{property:"og:title",content:"BlogX"},{property:"og:description",content:"ç°ä»£ä¼˜é›…çš„èŒä¸šåšå®¢æ¨¡ç‰ˆï¼ŒåŠ©åŠ›è·³æ§½ä¸èŒä¸šå±•ç¤ºã€‚"},{property:"og:type",content:"website"}],link:[{rel:"canonical",href:"https://example.com/"}]}),(e,v)=>{const w=B("router-link");return i(),d("section",ie,[t("div",ce,[v[1]||(v[1]=t("div",null,[t("h1",{class:"text-2xl font-bold"},"BlogX èŒä¸šåšå®¢"),t("p",{class:"text-sm text-slate-500 dark:text-slate-400"},"å±•ç¤ºä½ çš„ä¸“ä¸šå½¢è±¡ï¼Œä¸æ‹›è˜æ–¹å»ºç«‹è¿æ¥ã€‚")],-1)),n.value?(i(),A(w,{key:0,to:"/editor",class:"inline-flex items-center gap-2 rounded-full bg-brand px-4 py-2 text-sm font-medium text-white hover:bg-brand-dark"},{default:C(()=>[...v[0]||(v[0]=[T(" âœï¸ æ–°å»ºæ–‡ç«  ",-1)])]),_:1})):E("",!0)]),b(J,{categories:M(s).categories,tags:M(s).tags,onChange:l},null,8,["categories","tags"]),o.value.length?(i(),A(re,{key:0,items:o.value,"item-size":me,height:pe,"key-field":"id",class:"rounded-2xl border border-transparent bg-transparent"},{default:C(({item:S})=>[b(le,{post:S,class:"mb-4"},null,8,["post"])]),_:1},8,["items"])):(i(),d("p",ue,"æš‚æ— åŒ¹é…çš„æ–‡ç« ã€‚")),b(ne,{onIntersect:g})])}}};export{he as default};
